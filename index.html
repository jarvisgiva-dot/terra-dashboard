<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra BI v4.0 - Deep Insight</title>
    
    <!-- Stack -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <style>
        body { background-color: #020617; color: #e2e8f0; font-family: 'Inter', sans-serif; }
        .card { background-color: #0f172a; border: 1px solid #1e293b; border-radius: 0.75rem; padding: 1.5rem; position: relative; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .chart-container { position: relative; height: 300px; width: 100%; }
        [x-cloak] { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="p-4 md:p-8" x-data="app()" x-init="init()">

    <!-- Security Gate -->
    <div x-show="!authenticated" class="fixed inset-0 bg-black/90 flex items-center justify-center z-50 transition-opacity">
        <div class="card w-96 text-center border-emerald-900/50 shadow-[0_0_50px_rgba(16,185,129,0.2)]">
            <h2 class="text-2xl font-bold text-emerald-400 mb-2">STARK INDUSTRIES</h2>
            <p class="text-slate-500 text-xs uppercase tracking-widest mb-6">Terra Intelligence Division</p>
            <input type="password" x-model="password" class="w-full bg-slate-900/50 border border-slate-700 rounded p-3 text-white mb-4 text-center focus:border-emerald-500 outline-none transition" placeholder="Autentica√ß√£o">
            <button @click="login()" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-2 px-4 rounded transition shadow-lg shadow-emerald-900/50">ACESSAR SISTEMA</button>
            <p x-show="authError" class="text-red-500 text-xs mt-4">Credenciais inv√°lidas.</p>
        </div>
    </div>

    <!-- Main Interface -->
    <div x-show="authenticated" x-cloak class="max-w-[1600px] mx-auto space-y-6">
        
        <!-- Header & Filters -->
        <header class="bg-slate-900/50 rounded-2xl border border-slate-800 backdrop-blur-sm sticky top-0 z-40 shadow-xl transition-all duration-300">
            <!-- Top Row: Title + Toggle -->
            <div class="flex justify-between items-center p-4">
                <div class="flex items-center gap-3">
                    <h1 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-2">
                        üöú TERRA BI <span class="text-xs bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 px-2 py-1 rounded">v4.1</span>
                    </h1>
                </div>
                
                <button @click="showFilters = !showFilters" class="text-slate-400 hover:text-white transition p-2 bg-slate-800/50 rounded-lg">
                    <span x-text="showFilters ? 'üîº Ocultar Filtros' : 'üîΩ Filtros'"></span>
                </button>
            </div>
            
            <!-- Collapsible Filters Area -->
            <div x-show="showFilters" x-collapse class="px-6 pb-6 border-t border-slate-800 pt-4 flex flex-wrap gap-4 items-center">
                <!-- Simulador de Pre√ßo -->
                <div class="flex items-center gap-2 bg-slate-800 p-2 rounded-lg border border-slate-700">
                    <span class="text-xs text-slate-400 uppercase font-bold px-2">Simulador (R$/sc)</span>
                    <input type="number" x-model="simulacao.precoSaca" @input.debounce.500ms="updateSimulacao()" class="w-24 bg-slate-900 border border-slate-600 rounded p-1 text-right text-emerald-400 font-bold outline-none">
                </div>

                <div class="h-8 w-px bg-slate-700 mx-2 hidden md:block"></div>

                <!-- Filters -->
                <select x-model="filters.safra" class="bg-slate-800 border border-slate-600 text-white rounded-lg p-2.5 text-sm hover:border-emerald-500 transition cursor-pointer">
                    <option value="ALL">üìÖ Todas as Safras</option>
                    <template x-for="s in uniqueSafras">
                        <option :value="s" x-text="s"></option>
                    </template>
                </select>

                <select x-model="filters.cultura" class="bg-slate-800 border border-slate-600 text-white rounded-lg p-2.5 text-sm hover:border-emerald-500 transition cursor-pointer">
                    <option value="ALL">üå± Todas as Culturas</option>
                    <option value="SOJA">SOJA</option>
                    <option value="MILHO">MILHO</option>
                </select>
            </div>
        </header>

        <!-- KPI Deck (High Level) -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <!-- Custo -->
            <div class="card border-l-4 border-red-500 hover:bg-slate-800/50 transition">
                <div class="card-header">
                    <p class="text-slate-400 text-xs uppercase tracking-wider font-bold">Custo M√©dio Realizado</p>
                    <span class="text-red-500 text-lg">üí∞</span>
                </div>
                <p class="text-3xl font-bold text-white" x-text="formatMoney(kpis.custoMedioHa)"></p>
                <p class="text-xs mt-2 text-slate-500">por hectare</p>
            </div>

            <!-- Produtividade -->
            <div class="card border-l-4 border-emerald-500 hover:bg-slate-800/50 transition">
                <div class="card-header">
                    <p class="text-slate-400 text-xs uppercase tracking-wider font-bold">Produtividade M√©dia</p>
                    <span class="text-emerald-500 text-lg">üåæ</span>
                </div>
                <p class="text-3xl font-bold text-white"><span x-text="formatNumber(kpis.prodMedia)"></span> <span class="text-lg text-slate-400">sc/ha</span></p>
                <p class="text-xs mt-2" x-show="kpis.refImea" :class="kpis.prodMedia > kpis.refImea?.ref_prod_sc_ha ? 'text-emerald-400' : 'text-yellow-400'">
                    <span x-text="kpis.prodMedia > kpis.refImea?.ref_prod_sc_ha ? '‚ñ≤ Acima' : '‚ñº Abaixo'"></span> da ref. IMEA (<span x-text="kpis.refImea?.ref_prod_sc_ha"></span>)
                </p>
            </div>

            <!-- Radar Competitivo (Benchmark Detalhado) -->
            <div class="card border-l-4 border-orange-500 hover:bg-slate-800/50 transition col-span-1 md:col-span-2 lg:col-span-1">
                <div class="card-header">
                    <p class="text-slate-400 text-xs uppercase tracking-wider font-bold">Radar de Custos (R$/ha)</p>
                    <span class="text-orange-500 text-lg">üéØ</span>
                </div>
                <div class="space-y-3 mt-2" x-show="kpis.refImea">
                    <template x-for="(refVal, key) in kpis.refImea?.detalhes">
                        <div class="flex justify-between items-center text-sm border-b border-slate-800 pb-1">
                            <span class="text-slate-300" x-text="key"></span>
                            <div class="text-right">
                                <!-- C√°lculo aproximado do custo real por categoria -->
                                <span class="font-bold text-white" x-text="formatMoney(kpis.custoPorCategoria[key]?.total / kpis.areaTotal || 0)"></span>
                                <span class="text-xs ml-1" :class="(kpis.custoPorCategoria[key]?.total / kpis.areaTotal) > refVal ? 'text-red-400' : 'text-emerald-400'">
                                    vs <span x-text="formatNumber(refVal)"></span>
                                </span>
                            </div>
                        </div>
                    </template>
                </div>
                <div x-show="!kpis.refImea" class="text-xs text-slate-500 mt-2">Selecione uma cultura para ver o benchmark.</div>
            </div>

            <!-- Melhor Variedade -->
            <div class="card border-l-4 border-purple-500 hover:bg-slate-800/50 transition">
                <div class="card-header">
                    <p class="text-slate-400 text-xs uppercase tracking-wider font-bold">Variedade Campe√£</p>
                    <span class="text-purple-500 text-lg">üèÜ</span>
                </div>
                <p class="text-xl font-bold text-white truncate" x-text="kpis.bestVariety.name || '--'"></p>
                <p class="text-xs mt-2 text-emerald-400"><span x-text="formatNumber(kpis.bestVariety.val)"></span> sc/ha m√©dia</p>
            </div>
        </div>

        <!-- Deep Dive Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- 1. Variedades (Bar Chart) -->
            <div class="card lg:col-span-2">
                <div class="card-header">
                    <h3 class="text-lg font-bold text-white">üß¨ Comparativo de Variedades</h3>
                    <div class="text-xs text-slate-500">M√©dia de Produtividade (sc/ha)</div>
                </div>
                <div class="chart-container">
                    <canvas id="varietyChart"></canvas>
                </div>
            </div>

            <!-- 2. Pareto de Custos (Pie/List) -->
            <div class="card lg:col-span-1">
                <div class="card-header">
                    <h3 class="text-lg font-bold text-white">üí∏ Pareto de Custos</h3>
                    <div class="text-xs text-slate-500">Top ofensores</div>
                </div>
                <div class="chart-container" style="height: 200px;">
                    <canvas id="paretoChart"></canvas>
                </div>
                <!-- Mini List -->
                <div class="mt-4 space-y-2 h-24 overflow-y-auto pr-2">
                    <template x-for="c in paretoCustos">
                        <div class="flex justify-between text-sm border-b border-slate-800 pb-1">
                            <span class="text-slate-300 truncate w-2/3" x-text="c.item"></span>
                            <span class="text-white font-bold" x-text="formatMoney(c.valor)"></span>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- 3. Talh√µes Scatter Plot (Advanced) -->
        <div class="card">
            <div class="card-header">
                <h3 class="text-lg font-bold text-white">üó∫Ô∏è Raio-X dos Talh√µes (Produtividade vs √Årea)</h3>
                <div class="flex gap-2">
                    <span class="text-xs flex items-center gap-1 text-slate-400"><span class="w-2 h-2 rounded-full bg-emerald-500"></span> Alta Prod.</span>
                    <span class="text-xs flex items-center gap-1 text-slate-400"><span class="w-2 h-2 rounded-full bg-red-500"></span> Baixa Prod.</span>
                </div>
            </div>
            <div class="chart-container" style="height: 400px;">
                <canvas id="scatterChart"></canvas>
            </div>
            <p class="text-xs text-center text-slate-500 mt-2">Cada ponto √© um talh√£o. Pontos mais altos = Mais produtivos. Pontos mais √† direita = Talh√µes maiores.</p>
        </div>

        <!-- Data Grid -->
        <div class="card">
            <div class="card-header">
                <h3 class="text-lg font-bold text-white">üìã Detalhamento por Talh√£o</h3>
                <input type="text" x-model="search" placeholder="Filtrar talh√£o..." class="bg-slate-900 border border-slate-700 rounded p-1 text-sm text-white w-48">
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-slate-300">
                    <thead class="text-xs uppercase bg-slate-800 text-slate-400">
                        <tr>
                            <th class="px-4 py-3">Safra</th>
                            <th class="px-4 py-3">Fazenda</th>
                            <th class="px-4 py-3">Talh√£o</th>
                            <th class="px-4 py-3">Variedade</th>
                            <th class="px-4 py-3 text-right">√Årea (ha)</th>
                            <th class="px-4 py-3 text-right">Prod (sc/ha)</th>
                            <th class="px-4 py-3 text-right">Rentabilidade (Est.)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-for="row in filteredProd">
                            <tr class="border-b border-slate-800 hover:bg-slate-800/80 transition">
                                <td class="px-4 py-2" x-text="row.safra"></td>
                                <td class="px-4 py-2" x-text="row.fazenda"></td>
                                <td class="px-4 py-2 font-bold text-white" x-text="row.talhao"></td>
                                <td class="px-4 py-2 text-xs text-slate-400" x-text="row.variedade"></td>
                                <td class="px-4 py-2 text-right" x-text="row.area.toFixed(1)"></td>
                                <td class="px-4 py-2 text-right font-bold" :class="row.prod_sc_ha >= kpis.prodMedia ? 'text-emerald-400' : 'text-yellow-500'" x-text="row.prod_sc_ha.toFixed(1)"></td>
                                <td class="px-4 py-2 text-right font-mono" :class="calculateMargin(row) > 0 ? 'text-blue-300' : 'text-red-400'" x-text="formatMoney(calculateMargin(row))"></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Custos Detalhados -->
        <div class="card">
            <div class="card-header">
                <h3 class="text-lg font-bold text-white">üí∏ Detalhamento de Custos</h3>
                <div class="text-xs text-slate-500">Custos por item (filtrados por safra e cultura)</div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-slate-300">
                    <thead class="text-xs uppercase bg-slate-800 text-slate-400">
                        <tr>
                            <th class="px-4 py-3">Safra</th>
                            <th class="px-4 py-3">Cultura</th>
                            <th class="px-4 py-3">Categoria</th>
                            <th class="px-4 py-3">Item</th>
                            <th class="px-4 py-3 text-right">Valor (R$)</th>
                            <th class="px-4 py-3 text-right">Custo/ha (R$)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-for="row in filteredCustos">
                            <tr class="border-b border-slate-800 hover:bg-slate-800/80 transition">
                                <td class="px-4 py-2" x-text="row.safra"></td>
                                <td class="px-4 py-2" x-text="row.cultura"></td>
                                <td class="px-4 py-2 text-xs bg-slate-800 px-2 py-1 rounded w-fit" x-text="row.categoria"></td>
                                <td class="px-4 py-2 text-xs text-slate-400" x-text="row.item"></td>
                                <td class="px-4 py-2 text-right font-bold" x-text="formatMoney(row.valor)"></td>
                                <td class="px-4 py-2 text-right" x-text="formatMoney(row.custo_ha)"></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
            <div x-show="filteredCustos.length === 0" class="text-center py-8 text-slate-500">
                Nenhum custo registrado para essa combina√ß√£o de safra e cultura.
            </div>
        </div>

    </div>

    <!-- Application Logic -->
    <script>
        function app() {
            return {
                authenticated: false,
                password: '',
                authError: false,
                showFilters: true, // Controle de visibilidade dos filtros
                db: null,
                filters: { safra: 'ALL', cultura: 'ALL' },
                simulacao: { precoSaca: 120 }, // Default price
                search: '',
                charts: {},

                login() {
                    if (this.password === 'jarvis4.0') {
                        this.authenticated = true;
                        this.loadData();
                    } else {
                        this.authError = true;
                    }
                },

                async loadData() {
                    const res = await fetch('./data/database.json');
                    this.db = await res.json();
                    
                    // Watchers
                    this.$watch('filters', () => this.updateAllCharts());
                    this.$watch('simulacao.precoSaca', () => {/* Reactivity handles table */});
                    
                    this.updateAllCharts();
                },

                // --- Getters & Computeds ---

                get uniqueSafras() {
                    if(!this.db) return [];
                    const safras = new Set([
                        ...this.db.custos.map(c => c.safra),
                        ...this.db.produtividade.map(p => p.safra)
                    ]);
                    return Array.from(safras).sort();
                },

                get filteredProd() {
                    if (!this.db) return [];
                    return this.db.produtividade.filter(p => {
                        const matchSafra = this.filters.safra === 'ALL' || p.safra === this.filters.safra;
                        const matchCultura = this.filters.cultura === 'ALL' || p.cultura === this.filters.cultura;
                        const matchSearch = this.search === '' || p.talhao.toLowerCase().includes(this.search.toLowerCase());
                        return matchSafra && matchCultura && matchSearch;
                    }).sort((a,b) => b.prod_sc_ha - a.prod_sc_ha); // Sort by best performance
                },

                get filteredCustos() {
                    if (!this.db) return [];
                    return this.db.custos.filter(c => {
                        const matchSafra = this.filters.safra === 'ALL' || c.safra === this.filters.safra;
                        const matchCultura = this.filters.cultura === 'ALL' || c.cultura === this.filters.cultura;
                        return matchSafra && matchCultura;
                    });
                },

                get kpis() {
                    const prods = this.filteredProd;
                    const custos = this.filteredCustos;
                    
                    const areaTotal = prods.reduce((acc, p) => acc + p.area, 0);
                    const totalSc = prods.reduce((acc, p) => acc + p.total_sc, 0);
                    
                    // Custo Total (Soma tudo)
                    const custoTotal = custos.reduce((acc, c) => acc + c.valor, 0);
                    
                    // Custo M√©dio Ponderado por Categoria (para benchmark)
                    const custoPorCategoria = {};
                    custos.forEach(c => {
                        // Agrupa itens em categorias chave
                        let cat = c.item; 
                        if(c.item.includes("HERBICIDA") || c.item.includes("FUNGICIDA") || c.item.includes("INSETICIDA")) cat = "DEFENSIVOS";
                        
                        if(!custoPorCategoria[cat]) custoPorCategoria[cat] = { total: 0, count: 0 };
                        custoPorCategoria[cat].total += c.valor;
                    });

                    const prodMedia = areaTotal > 0 ? totalSc / areaTotal : 0;
                    
                    // Custo M√©dio Ha = Custo Total / Area Plantada (aproximado, pois areaTotal vem de produtividade que pode ser parcial)
                    // Melhor usar a m√©dia dos custos unit√°rios se dispon√≠vel, ou divis√£o bruta
                    const custoMedioHa = areaTotal > 0 ? custoTotal / areaTotal : 0;
                    
                    // Margem Estimada
                    const receitaEstimada = totalSc * this.simulacao.precoSaca;
                    const margem = areaTotal > 0 ? (receitaEstimada - custoTotal) / areaTotal : 0;

                    // Reference
                    let refImea = null;
                    if(this.db && this.filters.cultura !== 'ALL') {
                        refImea = this.db.referencias.find(r => r.cultura === this.filters.cultura);
                    }

                    // Best Variety
                    const vars = {};
                    prods.forEach(p => {
                        if(!vars[p.variedade]) vars[p.variedade] = { totalSc: 0, totalArea: 0 };
                        vars[p.variedade].totalSc += p.total_sc;
                        vars[p.variedade].totalArea += p.area;
                    });
                    
                    let bestVar = { name: '', val: 0 };
                    Object.keys(vars).forEach(k => {
                        const avg = vars[k].totalArea > 0 ? vars[k].totalSc / vars[k].totalArea : 0;
                        if(avg > bestVar.val) bestVar = { name: k, val: avg };
                    });

                    return { areaTotal, prodMedia, custoMedioHa, margem, bestVariety: bestVar, refImea, custoPorCategoria };
                },

                get paretoCustos() {
                    const sorted = [...this.filteredCustos].sort((a,b) => b.valor - a.valor);
                    return sorted.slice(0, 5); // Top 5
                },

                calculateMargin(row) {
                    // Margem = (Produtividade * Pre√ßo) - Custo M√©dio da Safra
                    // Nota: Usa custo m√©dio global da safra selecionada, pois custo por talh√£o n√£o temos no PDF
                    const receita = row.prod_sc_ha * this.simulacao.precoSaca;
                    return receita - this.kpis.custoMedioHa;
                },

                updateSimulacao() {
                    // Triggered by input, reactivity handles the rest in Alpine
                },

                // --- Chart Logic ---

                updateAllCharts() {
                    if (!this.db) return;
                    this.renderVarietyChart();
                    this.renderScatterChart();
                    this.renderParetoChart();
                },

                renderVarietyChart() {
                    const ctx = document.getElementById('varietyChart');
                    if(this.charts.variety) this.charts.variety.destroy();

                    // Group Data
                    const groups = {};
                    this.filteredProd.forEach(p => {
                        if(!groups[p.variedade]) groups[p.variedade] = { sc: 0, ha: 0 };
                        groups[p.variedade].sc += p.total_sc;
                        groups[p.variedade].ha += p.area;
                    });

                    const labels = Object.keys(groups);
                    const data = labels.map(l => groups[l].ha > 0 ? groups[l].sc / groups[l].ha : 0);

                    // Colors based on performance relative to avg
                    const avg = this.kpis.prodMedia;
                    const colors = data.map(v => v >= avg ? '#10b981' : '#f59e0b');

                    this.charts.variety = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Produtividade (sc/ha)',
                                data: data,
                                backgroundColor: colors,
                                borderRadius: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: false, grid: { color: '#334155' }, ticks: { color: '#94a3b8' } },
                                x: { grid: { display: false }, ticks: { color: '#94a3b8' } }
                            }
                        }
                    });
                },

                renderScatterChart() {
                    const ctx = document.getElementById('scatterChart');
                    if(this.charts.scatter) this.charts.scatter.destroy();

                    const points = this.filteredProd.map(p => ({
                        x: p.area,
                        y: p.prod_sc_ha,
                        talhao: p.talhao,
                        variedade: p.variedade
                    }));

                    const avgProd = this.kpis.prodMedia;

                    this.charts.scatter = new Chart(ctx, {
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: 'Talh√µes',
                                data: points,
                                backgroundColor: points.map(p => p.y >= avgProd ? '#10b981' : '#ef4444'),
                                pointRadius: 6,
                                pointHoverRadius: 8
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                tooltip: {
                                    callbacks: {
                                        label: (ctx) => {
                                            const p = ctx.raw;
                                            return `${p.talhao} (${p.variedade}): ${p.y.toFixed(1)} sc/ha em ${p.x.toFixed(1)} ha`;
                                        }
                                    }
                                },
                                legend: { display: false },
                                annotation: { // Simple line for average
                                    annotations: {
                                        line1: {
                                            type: 'line',
                                            yMin: avgProd,
                                            yMax: avgProd,
                                            borderColor: 'rgba(255, 255, 255, 0.2)',
                                            borderWidth: 2,
                                            borderDash: [5, 5]
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: { title: { display: true, text: '√Årea (hectares)', color: '#64748b' }, grid: { color: '#334155' }, ticks: { color: '#94a3b8' } },
                                y: { title: { display: true, text: 'Produtividade (sc/ha)', color: '#64748b' }, grid: { color: '#334155' }, ticks: { color: '#94a3b8' } }
                            }
                        }
                    });
                },

                renderParetoChart() {
                    const ctx = document.getElementById('paretoChart');
                    if(this.charts.pareto) this.charts.pareto.destroy();

                    // Group by Item (not just category)
                    const items = {};
                    this.filteredCustos.forEach(c => {
                        if(!items[c.item]) items[c.item] = 0;
                        items[c.item] += c.valor;
                    });

                    // Sort & Top 5
                    const sortedItems = Object.entries(items).sort((a,b) => b[1] - a[1]).slice(0, 5);
                    const labels = sortedItems.map(i => i[0].substring(0, 15) + '...');
                    const data = sortedItems.map(i => i[1]);

                    this.charts.pareto = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: data,
                                backgroundColor: ['#ef4444', '#f97316', '#eab308', '#3b82f6', '#6366f1'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'right', labels: { color: '#cbd5e1', boxWidth: 10, font: { size: 10 } } }
                            }
                        }
                    });
                },

                formatMoney(val) {
                    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(val);
                },
                formatNumber(val) {
                    return new Intl.NumberFormat('pt-BR').format(val);
                }
            }
        }
    </script>
</body>
</html>
